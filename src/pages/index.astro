---
// src/pages/index.astro
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import { getCollection } from 'astro:content';

const courses = await getCollection('courses');
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<style>
			.search-section {
				text-align: center;
				padding: 4rem 1rem;
				background: #f0f2f5;
				margin-bottom: 2rem;
			}
			input#courseSearch {
				width: 100%;
				max-width: 600px;
				padding: 1rem;
				font-size: 1.2rem;
				border: 2px solid #ccc;
				border-radius: 8px;
				margin-top: 1rem;
			}
			.grid {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
				gap: 1.5rem;
				max-width: 1200px;
				margin: 0 auto;
				padding: 0 1rem;
			}
			.card {
				border: 1px solid #eee;
				padding: 1.5rem;
				border-radius: 12px;
				transition: transform 0.2s, box-shadow 0.2s;
				text-decoration: none;
				color: inherit;
				display: block;
			}
			.card:hover {
				transform: translateY(-3px);
				box-shadow: 0 10px 20px rgba(0,0,0,0.1);
				border-color: var(--accent);
			}
			.badge {
				background: var(--accent);
				color: white;
				padding: 4px 8px;
				border-radius: 4px;
				font-size: 0.8em;
				text-transform: uppercase;
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<div class="search-section">
				<h1>ðŸŽ“ Find Your Course</h1>
				<p>Search the database for SCQF learning materials.</p>
				<input type="text" id="courseSearch" placeholder="e.g. National 5 Maths..." />
			</div>

			<div class="grid" id="courseGrid">
				{courses.map((course) => (
					<a href={`/courses/${course.id}`} class="card" data-title={course.data.title.toLowerCase()}>
						<h3>{course.data.title}</h3>
						<span class="badge">{course.data.level}</span>
						<p>{course.data.description}</p>
					</a>
				))}
			</div>
		</main>
		<Footer />

		<script>
			const input = document.getElementById('courseSearch');
			const cards = document.querySelectorAll('.card');

			input.addEventListener('input', (e) => {
				const term = e.target.value.toLowerCase();
				cards.forEach(card => {
					const title = card.getAttribute('data-title');
					if(title.includes(term)) {
						card.style.display = 'block';
					} else {
						card.style.display = 'none';
					}
				});
			});
		</script>
	</body>
</html>